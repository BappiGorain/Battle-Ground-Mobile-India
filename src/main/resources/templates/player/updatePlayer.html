<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gaming Arena - Edit Profile</title>
    <link rel="stylesheet" th:href="@{/css/output.css}">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        /* Custom animations and effects */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(139, 92, 246, 0.3); }
            50% { box-shadow: 0 0 30px rgba(139, 92, 246, 0.6), 0 0 40px rgba(59, 130, 246, 0.4); }
        }
        
        @keyframes slideInUp {
            0% { transform: translateY(50px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .floating { animation: float 6s ease-in-out infinite; }
        .glow-effect { animation: glow 2s ease-in-out infinite; }
        .slide-up { animation: slideInUp 1s ease-out; }
        .pulse-effect { animation: pulse 3s ease-in-out infinite; }
        .gradient-animate { animation: gradientShift 4s ease infinite; }
        
        /* Gaming particles background */
        .particles {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            overflow: hidden;
            z-index: 0;
            pointer-events: none;
        }
        
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: linear-gradient(45deg, #8b5cf6, #3b82f6);
            border-radius: 50%;
            animation: particleMove 15s linear infinite;
        }
        
        @keyframes particleMove {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }
        
        /* Neon text effect */
        .neon-text {
            text-shadow: 0 0 10px #8b5cf6, 0 0 20px #8b5cf6, 0 0 30px #8b5cf6;
        }
        
        /* Gaming button style */
        .gaming-btn {
            position: relative;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 2px solid transparent;
            background-clip: padding-box;
            transition: all 0.3s ease;
        }
        
        .gaming-btn:before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            z-index: -1;
            margin: -2px;
            border-radius: inherit;
            background: linear-gradient(135deg, #8b5cf6, #3b82f6, #06b6d4);
        }
        
        .gaming-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.4);
        }
        
        /* Interactive form fields */
        .interactive-input {
            transition: all 0.3s ease;
        }
        
        .interactive-input:focus {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.2);
        }
        
        /* Photo upload area */
        .photo-upload-area {
            transition: all 0.3s ease;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(59, 130, 246, 0.1));
            border: 2px dashed rgba(139, 92, 246, 0.3);
        }
        
        .photo-upload-area:hover {
            border-color: rgba(139, 92, 246, 0.6);
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(59, 130, 246, 0.2));
            transform: scale(1.02);
        }
        
        .photo-upload-area.dragover {
            border-color: #8b5cf6;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3), rgba(59, 130, 246, 0.3));
            transform: scale(1.05);
        }
        
        /* Avatar preview */
        .avatar-preview {
            transition: all 0.3s ease;
        }
        
        .avatar-preview:hover {
            transform: scale(1.1);
            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.4);
        }
        
        /* Cyberpunk grid overlay */
        .cyber-grid {
            background-image: 
                linear-gradient(rgba(139, 92, 246, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(139, 92, 246, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        
        /* Progress bar animation */
        .progress-bar {
            background: linear-gradient(90deg, #8b5cf6, #3b82f6, #06b6d4);
            background-size: 200% 100%;
            animation: gradientShift 2s ease infinite;
        }
        
        /* Notification styles */
        .notification {
            animation: slideInUp 0.5s ease-out;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-violet-900 relative">
    <!-- Animated particles background -->
    <div class="particles">
        <div class="cyber-grid"></div>
    </div>
    

    <!-- Navigation Bar -->
    <nav class="relative z-20 bg-black/30 backdrop-blur-xl border-b border-purple-500/30">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8" th:object="${player}">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-4">
                    <img th:src="@{/images/clan_logo.png}" alt="Gaming Arena" class="w-8 h-8 rounded-full">
                    <h1 class="text-xl font-bold text-white neon-text">GAMING ARENA</h1>
                </div>
                <div class="flex items-center gap-4">
                    <a th:href="@{/bgmi/profile}" class="text-white hover:text-purple-400 transition-colors">
                        <i class="ph-arrow-left text-xl"></i>
                    </a>
                    <button class="text-white hover:text-purple-400 transition-colors">
                        <i class="ph-bell text-xl"></i>
                    </button>
                    <a th:href="@{/bgmi/login}" class="gaming-btn px-4 py-2 rounded-lg text-white font-medium text-decoration-none">
                        <i class="ph-sign-out text-lg mr-2"></i>Logout
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="relative z-10 min-h-screen flex items-center justify-center p-4">
        <div class="w-full max-w-4xl">
            
            <!-- Header -->
            <div class="slide-up text-center mb-8">
                <h1 class="text-4xl lg:text-5xl font-black text-white neon-text mb-4">
                    EDIT <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-400">PROFILE</span>
                </h1>
                <p class="text-xl text-gray-300">Update your gaming profile and showcase your skills</p>
            </div>

            <!-- Success/Error Messages -->
            <div th:if="${successMessage}" class="notification slide-up mb-6 bg-green-500/20 border border-green-500/30 rounded-2xl p-4 text-green-400 text-center">
                <i class="ph-check-circle text-2xl mr-2"></i>
                <span th:text="${successMessage}">Success message</span>
            </div>

            <div th:if="${errorMessage}" class="notification slide-up mb-6 bg-red-500/20 border border-red-500/30 rounded-2xl p-4 text-red-400 text-center">
                <i class="ph-warning-circle text-2xl mr-2"></i>
                <span th:text="${errorMessage}">Error message</span>
            </div>

            <!-- Edit Form -->
            <div class="slide-up bg-black/20 backdrop-blur-2xl rounded-3xl shadow-2xl overflow-hidden border border-purple-500/30 glow-effect" style="animation-delay: 0.2s">
                <form th:action="@{/bgmi/update/{gameId}(gameId=${player.gameId})}" method="post" th:object="${player}" enctype="multipart/form-data" class="p-8 lg:p-12">
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        
                        <!-- Left Section - Photo Upload -->
                        <div class="space-y-6">
                            <h2 class="text-2xl font-bold text-white mb-6 flex items-center">
                                <i class="ph-camera mr-3 text-purple-400"></i>
                                Profile Photo
                            </h2>


                            <!-- <img th:src="${player.photoPath != null and !player.photoPath.isEmpty() and !player.photoPath.equals('default_bgmi_avatar.png')} ? @{${player.photoPath}} : @{/images/default_bgmi_avatar.jpeg}" alt="Gaming Arena" class="w-8 h-8 rounded-full"> -->
                            
                            <!-- Current Avatar Preview -->
                            <div class="text-center mb-6">
                                <div class="avatar-preview w-32 h-32 mx-auto rounded-full bg-gradient-to-br from-purple-500 to-cyan-500 p-1 floating">
                                    <img id="avatarPreview" 
                                         th:src="${player.photoPath != null and !player.photoPath.isEmpty() and !player.photoPath.equals('default_bgmi_avatar.png')} ? @{${player.photoPath}} : @{/images/default_bgmi_avatar.jpeg}"
                                         alt="Profile Avatar" 
                                         class="w-full h-full rounded-full object-cover bg-gray-800"/>
                                </div>
                                <p class="text-sm text-gray-400 mt-2">Current Profile Picture</p>
                            </div>
                            
                            <!-- Photo Upload Area -->
                            <div class="photo-upload-area rounded-2xl p-8 text-center cursor-pointer" id="photoUploadArea">
                                <input type="file" id="profilePhoto" name="profilePhoto" accept="image/*" class="hidden">
                                <div class="upload-content">
                                    <i class="ph-cloud-arrow-up text-4xl text-purple-400 mb-4 block"></i>
                                    <p class="text-white font-bold mb-2">Drop your photo here or click to browse</p>
                                    <p class="text-sm text-gray-400 mb-4">Supports: JPG, PNG, GIF (Max 5MB)</p>
                                    <button type="button" class="gaming-btn px-6 py-3 rounded-xl text-white font-bold">
                                        <i class="ph-folder-open mr-2"></i>Choose File
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Upload Progress -->
                            <div id="uploadProgress" class="hidden">
                                <div class="bg-gray-700 rounded-full h-2 mb-2">
                                    <div class="progress-bar h-2 rounded-full" id="progressBar" style="width: 0%"></div>
                                </div>
                                <p class="text-sm text-gray-400 text-center">Uploading... <span id="progressText">0%</span></p>
                            </div>
                        </div>
                        
                        <!-- Right Section - Form Fields -->
                        <div class="space-y-6">
                            <h2 class="text-2xl font-bold text-white mb-6 flex items-center">
                                <i class="ph-user-gear mr-3 text-cyan-400"></i>
                                Player Information
                            </h2>
                            
                            <!-- Player Name -->
                            <div class="relative group">
                                <label class="block text-sm font-medium text-gray-300 mb-2">
                                    <i class="ph-user mr-1"></i>Player Name
                                </label>
                                <input type="text" 
                                       th:field="*{name}"
                                       required
                                       class="interactive-input w-full px-4 py-4 rounded-2xl bg-white/10 border border-purple-500/30 text-white placeholder-gray-400 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 focus:outline-none backdrop-blur-sm"/>
                            </div>

                            <!-- Email -->
                            <div class="relative group">
                                <label class="block text-sm font-medium text-gray-300 mb-2">
                                    <i class="ph-envelope mr-1"></i>Email Address
                                </label>
                                <input type="email" 
                                       th:field="*{email}"
                                       required
                                       class="interactive-input w-full px-4 py-4 rounded-2xl bg-white/10 border border-blue-500/30 text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:outline-none backdrop-blur-sm"/>
                            </div>

                            <!-- Phone Number -->
                            <div class="relative group">
                                <label class="block text-sm font-medium text-gray-300 mb-2">
                                    <i class="ph-phone mr-1"></i>Phone Number
                                </label>
                                <input type="tel" 
                                       th:field="*{phoneNumber}"
                                       class="interactive-input w-full px-4 py-4 rounded-2xl bg-white/10 border border-green-500/30 text-white placeholder-gray-400 focus:ring-2 focus:ring-green-500 focus:border-green-500 focus:outline-none backdrop-blur-sm"/>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex flex-col sm:flex-row gap-4 mt-8 pt-6 border-t border-purple-500/30">
                        <button type="submit" class="gaming-btn flex-1 py-4 rounded-2xl text-white font-bold text-lg">
                            <i class="ph-floppy-disk mr-2"></i>Save Changes
                        </button>
                        <a th:href="@{/bgmi/profile}" class="bg-gray-600/20 hover:bg-gray-600/30 flex-1 py-4 rounded-2xl text-white font-bold text-lg text-center border border-gray-500/30 transition-all">
                            <i class="ph-x mr-2"></i>Cancel
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Photo Crop Modal -->
    <div id="cropModal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
        <div class="bg-black/40 backdrop-blur-xl rounded-3xl p-8 border border-purple-500/30 max-w-lg w-full">
            <h3 class="text-2xl font-bold text-white mb-4 text-center">Crop Your Photo</h3>
            <div class="bg-gray-800 rounded-2xl p-4 mb-4">
                <img id="cropImage" class="max-w-full h-auto rounded-lg" />
            </div>
            <div class="flex gap-4">
                <button id="cropConfirm" class="gaming-btn flex-1 py-3 rounded-xl text-white font-bold">
                    <i class="ph-check mr-2"></i>Apply Crop
                </button>
                <button id="cropCancel" class="bg-gray-600/20 hover:bg-gray-600/30 flex-1 py-3 rounded-xl text-white font-bold border border-gray-500/30 transition-all">
                    <i class="ph-x mr-2"></i>Cancel
                </button>
            </div>
        </div>
    </div>

    <script>
        // Create animated particles
        function createParticle() {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 15 + 's';
            particle.style.animationDuration = (Math.random() * 10 + 15) + 's';
            document.querySelector('.particles').appendChild(particle);
            
            setTimeout(() => {
                particle.remove();
            }, 25000);
        }

        setInterval(createParticle, 800);
        for (let i = 0; i < 15; i++) {
            setTimeout(createParticle, i * 300);
        }

        // Photo upload functionality
        const photoUploadArea = document.getElementById('photoUploadArea');
        const profilePhotoInput = document.getElementById('profilePhoto');
        const avatarPreview = document.getElementById('avatarPreview');
        const uploadProgress = document.getElementById('uploadProgress');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');

        // Click to upload
        photoUploadArea.addEventListener('click', () => {
            profilePhotoInput.click();
        });

        // Drag and drop functionality
        photoUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            photoUploadArea.classList.add('dragover');
        });

        photoUploadArea.addEventListener('dragleave', () => {
            photoUploadArea.classList.remove('dragover');
        });

        photoUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            photoUploadArea.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFileSelection(files[0]);
            }
        });

        // File input change
        profilePhotoInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFileSelection(e.target.files[0]);
            }
        });

        // Handle file selection
        function handleFileSelection(file) {
            // Validate file type
            if (!file.type.startsWith('image/')) {
                alert('Please select an image file.');
                return;
            }

            // Validate file size (5MB max)
            if (file.size > 5 * 1024 * 1024) {
                alert('File size must be less than 5MB.');
                return;
            }

            // Show upload progress
            uploadProgress.classList.remove('hidden');
            
            // Simulate upload progress
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 30;
                if (progress > 100) {
                    progress = 100;
                    clearInterval(interval);
                    setTimeout(() => {
                        uploadProgress.classList.add('hidden');
                    }, 1000);
                }
                
                progressBar.style.width = progress + '%';
                progressText.textContent = Math.round(progress) + '%';
            }, 100);

            // Preview the image
            const reader = new FileReader();
            reader.onload = (e) => {
                avatarPreview.src = e.target.result;
                avatarPreview.style.animation = 'pulse 1s ease-in-out';
            };
            reader.readAsDataURL(file);
        }

        // Password toggle
        function togglePassword() {
            const passwordField = document.getElementById('passwordField');
            const eyeIcon = document.getElementById('eyeIcon');
            
            if (passwordField.type === 'password') {
                passwordField.type = 'text';
                eyeIcon.className = 'ph-eye-slash text-xl';
            } else {
                passwordField.type = 'password';
                eyeIcon.className = 'ph-eye text-xl';
            }
        }

        // Form validation
        document.querySelector('form').addEventListener('submit', function(e) {
            const name = document.querySelector('[name="name"]').value;
            const gameId = document.querySelector('[name="gameId"]').value;
            const email = document.querySelector('[name="email"]').value;

            if (!name || !gameId || !email) {
                e.preventDefault();
                alert('Please fill in all required fields.');
                return;
            }

            // Show loading state on submit button
            const submitBtn = document.querySelector('button[type="submit"]');
            submitBtn.innerHTML = '<i class="ph-spinner mr-2"></i>Updating...';
            submitBtn.disabled = true;
        });

        // Interactive form field effects
        document.querySelectorAll('.interactive-input').forEach(input => {
            input.addEventListener('focus', function() {
                this.style.transform = 'translateY(-2px) scale(1.02)';
            });
            
            input.addEventListener('blur', function() {
                this.style.transform = 'translateY(0) scale(1)';
            });
        });

        // Auto-hide notifications
        setTimeout(() => {
            const notifications = document.querySelectorAll('.notification');
            notifications.forEach(notification => {
                notification.style.opacity = '0.7';
            });
        }, 5000);
    </script>
</body>
</html>
